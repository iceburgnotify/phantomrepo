{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Uncategorized",
    "coa": {
        "data": {
            "clean": true,
            "code_block": "",
            "description": "",
            "hash": "065f5bcf52a966269e4448dab32b5c6016ea7c97",
            "joint": {
                "cells": [
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'run_query_2' block\n    run_query_2(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fccef927-3404-42bc-ae37-99f6c141531a",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 16,
                        "line_start": 8,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 100,
                            "y": 100
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 1
                    },
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all detals of actions \n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "block sender",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "dd333f24-6778-4b25-b439-97ab35145a81",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 211,
                        "line_start": 198,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 760,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 2
                    },
                    {
                        "action": "whois domain",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "domain": "paypal.account.myorder-manage.com"
                        },
                        "angle": 0,
                        "app": "PassiveTotal",
                        "approver": "",
                        "assets": [
                            {
                                "action": "whois domain",
                                "active": true,
                                "app_name": "PassiveTotal",
                                "app_version": "1.2.28",
                                "asset_name": "passivetotal",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "domain": "paypal.account.myorder-manage.com"
                                },
                                "has_app": true,
                                "id": 144,
                                "loaded": false,
                                "missing": false,
                                "name": "passivetotal",
                                "output": [
                                    {
                                        "data_path": "action_result.data.*.tech.fax",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tech.city",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tech.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.tech.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tech.state",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tech.street",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tech.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tech.telephone",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tech.postalCode",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tech.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.fax",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.city",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.admin.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.state",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.street",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.telephone",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.postalCode",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.admin.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.domain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.expiresAt",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrar",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registered",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.fax",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.city",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.registrant.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.state",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.street",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.telephone",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.postalCode",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registrant.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.nameServers",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.whoisServer",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Contact Email",
                                        "column_order": 1,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.contactEmail",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.lastLoadedAt",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.registryUpdatedAt",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "City",
                                        "column_order": 2,
                                        "data_path": "action_result.summary.city",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Country",
                                        "column_order": 3,
                                        "data_path": "action_result.summary.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Organization",
                                        "column_order": 0,
                                        "data_path": "action_result.summary.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.parameter.domain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "domain": {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Domain to query",
                                        "key": "domain",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "PassiveTotal",
                                "product_vendor": "PassiveTotal",
                                "targets": "91",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "whois domain"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def whois_domain_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('whois_domain_1() called')\n\n    # collect data for 'whois_domain_1' call\n\n    parameters = []\n    \n    # build parameters list for 'whois_domain_1' call\n    parameters.append({\n        'domain': \"paypal.account.myorder-manage.com\",\n    })\n\n    phantom.act(\"whois domain\", parameters=parameters, assets=['passivetotal'], name=\"whois_domain_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fa6ed321-9104-456e-97b1-71f587a7392c",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 32,
                        "line_start": 16,
                        "message": "Configuring now",
                        "name": "whois domain",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 360,
                            "y": 400
                        },
                        "previous_function": "",
                        "previous_name": "whois_domain_1",
                        "required_params": {
                            "domain": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 8
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "b74c813d-365e-480e-bf1b-c5030b9b2b9b",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b99959e8-7935-4637-9302-06074ee6e239",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "0b8c8157-6228-4d3a-8621-c0c05367a99a",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 11
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "4c05d8ee-a0fe-4147-9d53-c5855e138fbb",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0b8c8157-6228-4d3a-8621-c0c05367a99a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "dd333f24-6778-4b25-b439-97ab35145a81",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 13
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "d534a6b4-d52c-41af-bfda-5dc498c48dca",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fe94a46a-7683-412d-9c73-8b7db6a14f00",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "3050c973-fe3f-4838-83ac-0f072e925cd6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 34
                    },
                    {
                        "action": "get screenshot",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "size": "",
                            "url": "https://paypal.account.myorder-manage.com/signin/"
                        },
                        "angle": 0,
                        "app": "Screenshot Machine",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get screenshot",
                                "active": true,
                                "app_name": "Screenshot Machine",
                                "app_version": "1.4.24",
                                "asset_name": "test ss",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "size": "",
                                    "url": "https://paypal.account.myorder-manage.com/signin/"
                                },
                                "has_app": true,
                                "id": 90,
                                "loaded": false,
                                "missing": false,
                                "name": "test ss",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Downloaded screenshot"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.summary.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://www.google.com_screenshot.jpg"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.size",
                                        "data_type": "string",
                                        "example_values": [
                                            48692
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "vault id",
                                            "sha1"
                                        ],
                                        "data_path": "action_result.summary.vault_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "025a0aed68c79a9dc14fa11654ed9a21d521f79e"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.summary.permalink",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "url",
                                            "domain"
                                        ],
                                        "data_path": "action_result.parameter.url",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://www.google.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.size",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.vault_file_path",
                                        "data_type": "string",
                                        "example_values": [
                                            "/opt/phantom/vault/02/5a/025a0aed68c79a9dc14fa11654ed9a21d521f79e"
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "size": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "size of the screenshot",
                                        "key": "size",
                                        "required": false,
                                        "value_list": [
                                            "Full Page",
                                            "Small",
                                            "Normal",
                                            "Medium",
                                            "Large",
                                            "Tiny"
                                        ]
                                    },
                                    "url": {
                                        "contains": [
                                            "url",
                                            "domain"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "url to screenshot",
                                        "key": "url",
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Screenshot Machine",
                                "product_vendor": "Screenshot Machine",
                                "targets": "68",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get screenshot"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.code image": {
                                "xlink:href": "/inc/coa/img/block_icon_code_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def get_screenshot_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('get_screenshot_1() called')\n\n    # collect data for 'get_screenshot_1' call\n\n    parameters = []\n    \n    # build parameters list for 'get_screenshot_1' call\n    parameters.append({\n        'url': \"https://paypal.account.myorder-manage.com/signin/\",\n        'size': \"\",\n    })\n\n    phantom.act(\"get screenshot\", parameters=parameters, assets=['test ss'], name=\"get_screenshot_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "def get_screenshot_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('get_screenshot_1() called')\n\n    # collect data for 'get_screenshot_1' call\n\n    parameters = []\n    \n    # build parameters list for 'get_screenshot_1' call\n    parameters.append({\n        'url': \"https://paypal.account.myorder-manage.com\",\n        'size': \"\",\n    })\n\n    phantom.act(\"get screenshot\", parameters=parameters, assets=['test ss'], name=\"get_screenshot_1\")\n\n    return",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "b91ce990-53b0-4b34-87fa-41ebc1b145df",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 54,
                        "line_start": 37,
                        "message": "Configuring now",
                        "name": "get screenshot",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 440,
                            "y": 240
                        },
                        "previous_function": "",
                        "previous_name": "get_screenshot_1",
                        "required_params": {
                            "url": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 38
                    },
                    {
                        "action": "send email",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "attachments": "",
                            "body": "this is testing",
                            "from": "gonnastopus@outlook.com",
                            "subject": "test delete",
                            "to": "soartesting2019@outlook.com"
                        },
                        "angle": 0,
                        "app": "SMTP",
                        "approver": "",
                        "assets": [
                            {
                                "action": "send email",
                                "active": true,
                                "app_name": "SMTP",
                                "app_version": "1.2.34",
                                "asset_name": "smtp",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "attachments": "",
                                    "body": "this is testing",
                                    "from": "gonnastopus@outlook.com",
                                    "subject": "test delete",
                                    "to": "soartesting2019@outlook.com"
                                },
                                "has_app": true,
                                "id": 64,
                                "loaded": false,
                                "missing": false,
                                "name": "smtp",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.body",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.to",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.from",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.attachments",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "attachments": {
                                        "allow_list": true,
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Vault IDs of files to attach",
                                        "key": "attachments",
                                        "order": 4,
                                        "required": false,
                                        "verbose": "Each file that is required to be attached, needs to be in the vault. Multiple file vault ids can be specified as comma seperated."
                                    },
                                    "body": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Message body",
                                        "key": "body",
                                        "order": 3,
                                        "required": true
                                    },
                                    "from": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "From field",
                                        "key": "from",
                                        "order": 0,
                                        "required": false
                                    },
                                    "subject": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Message Subject",
                                        "key": "subject",
                                        "order": 2,
                                        "required": false
                                    },
                                    "to": {
                                        "allow_list": true,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "List of recipients email addresses",
                                        "key": "to",
                                        "order": 1,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "SMTP",
                                "product_vendor": "Generic",
                                "targets": "47",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "send email"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def send_email_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('send_email_1() called')\n\n    # collect data for 'send_email_1' call\n\n    parameters = []\n    \n    # build parameters list for 'send_email_1' call\n    parameters.append({\n        'body': \"this is testing\",\n        'to': \"soartesting2019@outlook.com\",\n        'from': \"gonnastopus@outlook.com\",\n        'attachments': \"\",\n        'subject': \"test delete\",\n    })\n\n    phantom.act(\"send email\", parameters=parameters, assets=['smtp'], name=\"send_email_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "9d6ec776-35da-487e-97af-754900440d7d",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 79,
                        "line_start": 59,
                        "message": "Configuring now",
                        "name": "send email",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 560,
                            "y": 580
                        },
                        "previous_function": "",
                        "previous_name": "send_email_1",
                        "required_params": {
                            "body": true,
                            "to": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 54
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a0e9594a-34c5-4304-92af-69f25a48c7e6",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "e5e4ffbf-a952-4a94-910c-0d91def5576b",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "fe94a46a-7683-412d-9c73-8b7db6a14f00",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 57
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "call api",
                        "attrs": {
                            ".api": {
                                "text": "call api"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "xlink:href": "/inc/coa/img/block_icon_code_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "# read-only block view not available",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [],
                        "connected_to_start": true,
                        "connection_name": "delete email 1",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def call_api_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('call_api_1() called')\n    phantom.debug(results)\n    return",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "3050c973-fe3f-4838-83ac-0f072e925cd6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 84,
                        "line_start": 79,
                        "message": "Configuring now",
                        "name": "call api",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1340,
                            "y": 420
                        },
                        "previous_function": "",
                        "previous_name": "call_api_1",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "warn",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 69
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "951db918-8a73-40bc-af0e-191a596ac158",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "a39437ef-d373-42af-9b75-4e6159137fe6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "884c929a-f2fb-48e2-b284-a60093406899",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 85
                    },
                    {
                        "action": "run query",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "body": "",
                            "email": "iceburgnotify@gmail.com",
                            "folder": "Inbox",
                            "ignore_subfolders": "",
                            "internet_message_id": "",
                            "query": "",
                            "range": "0-10",
                            "sender": "",
                            "subject": ""
                        },
                        "angle": 0,
                        "app": "EWS for Office 365",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run query",
                                "active": true,
                                "app_name": "EWS for Office 365",
                                "app_version": "1.0.87",
                                "config_type": "app",
                                "fields": {
                                    "body": "",
                                    "email": "iceburgnotify@gmail.com",
                                    "folder": "Inbox",
                                    "ignore_subfolders": "",
                                    "internet_message_id": "",
                                    "query": "",
                                    "range": "0-10",
                                    "sender": "",
                                    "subject": ""
                                },
                                "has_app": true,
                                "id": 97,
                                "loaded": false,
                                "missing": false,
                                "name": "EWS for Office 365",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.body",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "mail folder",
                                            "mail folder path"
                                        ],
                                        "data_path": "action_result.parameter.folder",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.ignore_subfolders",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_path": "action_result.parameter.internet_message_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.query",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.range",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.sender",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Folder",
                                        "column_order": 3,
                                        "contains": [
                                            "mail folder"
                                        ],
                                        "data_path": "action_result.data.*.folder",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Folder Path",
                                        "column_order": 4,
                                        "contains": [
                                            "mail folder path"
                                        ],
                                        "data_path": "action_result.data.*.folder_path",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Received Time",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.t_DateTimeReceived",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Internet Message ID",
                                        "column_order": 5,
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_path": "action_result.data.*.t_InternetMessageId",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ItemId.@ChangeKey",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message ID",
                                        "column_order": 6,
                                        "contains": [
                                            "office 365 email id"
                                        ],
                                        "data_path": "action_result.data.*.t_ItemId.@Id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Sender",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Subject",
                                        "column_order": 0,
                                        "data_path": "action_result.data.*.t_Subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.emails_matched",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "body": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Substring to search in Body",
                                        "key": "body",
                                        "order": 4,
                                        "primary": false,
                                        "required": false
                                    },
                                    "email": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "User's Email (Mailbox to search in)",
                                        "key": "email",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "folder": {
                                        "contains": [
                                            "mail folder",
                                            "mail folder path"
                                        ],
                                        "data_type": "string",
                                        "default": "Inbox",
                                        "description": "Folder Name/Path (to search in)",
                                        "key": "folder",
                                        "order": 1,
                                        "required": false
                                    },
                                    "ignore_subfolders": {
                                        "data_type": "boolean",
                                        "default": null,
                                        "description": "Ignore subfolders",
                                        "key": "ignore_subfolders",
                                        "order": 7,
                                        "required": false
                                    },
                                    "internet_message_id": {
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Internet Message ID",
                                        "key": "internet_message_id",
                                        "order": 5,
                                        "primary": false,
                                        "required": false
                                    },
                                    "query": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "AQS string",
                                        "key": "query",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "range": {
                                        "data_type": "string",
                                        "default": "0-10",
                                        "description": "Email range to return (min_offset-max_offset)",
                                        "key": "range",
                                        "order": 6,
                                        "required": false
                                    },
                                    "sender": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Sender Email address to match",
                                        "key": "sender",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "subject": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Substring to search in Subject",
                                        "key": "subject",
                                        "order": 2,
                                        "required": false
                                    }
                                },
                                "product_name": "Office 365",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "run query 1"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def run_query_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('run_query_1() called')\n\n    # collect data for 'run_query_1' call\n\n    parameters = []\n    \n    # build parameters list for 'run_query_1' call\n    parameters.append({\n        'body': \"\",\n        'internet_message_id': \"\",\n        'sender': \"\",\n        'ignore_subfolders': \"\",\n        'range': \"0-10\",\n        'query': \"\",\n        'folder': \"Inbox\",\n        'email': \"iceburgnotify@gmail.com\",\n        'subject': \"\",\n    })\n\n    phantom.act(\"run query\", parameters=parameters, app={ \"name\": 'EWS for Office 365' }, name=\"run_query_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ac8d01ae-1091-42cc-ab05-bc5336621715",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 108,
                        "line_start": 84,
                        "message": "Configuring now",
                        "name": "run query",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1200,
                            "y": 100
                        },
                        "previous_function": "",
                        "previous_name": "run_query_1",
                        "required_params": {
                            "email": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "warn",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 105
                    },
                    {
                        "action": "delete email",
                        "action_type": "contain",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "email": "",
                            "id": "AQMkADAwATM3ZmYAZS0xZTcwLTYxZGQALTAwAi0wMAoARgAAA8sbs2bgxWhOm/D/136MLx0HAHgHnxYkWTlOk6pq0IWFAMxLAAACAQwAAAB4B58WJFk5TpOqatCFhQDMSwAAAAyVhDsAAAA="
                        },
                        "angle": 0,
                        "app": "EWS for Office 365",
                        "approver": "",
                        "assets": [
                            {
                                "action": "delete email",
                                "active": true,
                                "app_name": "EWS for Office 365",
                                "app_version": "1.0.87",
                                "asset_name": "office365",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "email": "",
                                    "id": "AQMkADAwATM3ZmYAZS0xZTcwLTYxZGQALTAwAi0wMAoARgAAA8sbs2bgxWhOm/D/136MLx0HAHgHnxYkWTlOk6pq0IWFAMxLAAACAQwAAAB4B58WJFk5TpOqatCFhQDMSwAAAAyVhDsAAAA="
                                },
                                "has_app": true,
                                "id": 97,
                                "loaded": false,
                                "missing": false,
                                "name": "office365",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message ID",
                                        "column_order": 0,
                                        "contains": [
                                            "office 365 email id"
                                        ],
                                        "data_path": "action_result.parameter.id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Status Message",
                                        "column_order": 1,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "email": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Email of the mailbox owner (used during impersonation)",
                                        "key": "email",
                                        "order": 1,
                                        "primary": false,
                                        "required": false
                                    },
                                    "id": {
                                        "allow_list": true,
                                        "contains": [
                                            "office 365 email id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Message IDs to delete (comma separated values supported)",
                                        "key": "id",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Office 365",
                                "product_vendor": "Microsoft",
                                "targets": "51",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "delete email 1"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Contain"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_contain.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def delete_email_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('delete_email_1() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'delete_email_1' call\n\n    parameters = []\n    \n    # build parameters list for 'delete_email_1' call\n    parameters.append({\n        'id': \"AQMkADAwATM3ZmYAZS0xZTcwLTYxZGQALTAwAi0wMAoARgAAA8sbs2bgxWhOm/D/136MLx0HAHgHnxYkWTlOk6pq0IWFAMxLAAACAQwAAAB4B58WJFk5TpOqatCFhQDMSwAAAAyVhDsAAAA=\",\n        'email': \"\",\n    })\n\n    phantom.act(\"delete email\", parameters=parameters, assets=['office365'], callback=call_api_1, name=\"delete_email_1\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "get email",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fe94a46a-7683-412d-9c73-8b7db6a14f00",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 147,
                        "line_start": 128,
                        "message": "Configuring now",
                        "name": "delete email",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1240,
                            "y": 280
                        },
                        "previous_function": "",
                        "previous_name": "delete_email_1",
                        "required_params": {
                            "id": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Contain",
                        "type": "coa.Action",
                        "warn": "",
                        "z": 121
                    },
                    {
                        "action": "block sender",
                        "action_type": "contain",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "email": "",
                            "id": "AQMkADAwATM3ZmYAZS0xZTcwLTYxZGQALTAwAi0wMAoARgAAA8sbs2bgxWhOm/D/136MLx0HAHgHnxYkWTlOk6pq0IWFAMxLAAACAQwAAAB4B58WJFk5TpOqatCFhQDMSwAAAAyVhDwAAAA=",
                            "move_to_junk_folder": ""
                        },
                        "angle": 0,
                        "app": "EWS for Office 365",
                        "approver": "",
                        "assets": [
                            {
                                "action": "block sender",
                                "active": true,
                                "app_name": "EWS for Office 365",
                                "app_version": "1.0.87",
                                "asset_name": "office365",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "email": "",
                                    "id": "AQMkADAwATM3ZmYAZS0xZTcwLTYxZGQALTAwAi0wMAoARgAAA8sbs2bgxWhOm/D/136MLx0HAHgHnxYkWTlOk6pq0IWFAMxLAAACAQwAAAB4B58WJFk5TpOqatCFhQDMSwAAAAyVhDwAAAA=",
                                    "move_to_junk_folder": ""
                                },
                                "has_app": true,
                                "id": 97,
                                "loaded": false,
                                "missing": false,
                                "name": "office365",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.email",
                                        "data_type": "string",
                                        "example_values": [
                                            "foo@bar.onmicrosoft.com"
                                        ]
                                    },
                                    {
                                        "column_name": "Input Email ID",
                                        "column_order": 0,
                                        "contains": [
                                            "office 365 email id"
                                        ],
                                        "data_path": "action_result.parameter.id",
                                        "data_type": "string",
                                        "example_values": [
                                            "AAMkADVjNTI3MTYxLTYyZDMtNGViYy04MTFhLWZjYjQxYzNmNmI2YwBGAAAAAACJMZRks2m2Qp8kJOYtQ/E0BwC63sxpeq+QSJSiCN540EaIAAAAAAEMAAC63sxpeq+QSJSiCN540EaIAAHWGo0OAAA="
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.move_to_junk_folder",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "column_name": "New Email ID",
                                        "column_order": 1,
                                        "contains": [
                                            "office 365 email id"
                                        ],
                                        "data_path": "action_result.data.*.new_email_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "AAMkADVjNTI3MTYxLTYyZDMtNGViYy04MTFhLWZjYjQxYzNmNmI2YwBGAAAAAACJMZRks2m2Qp8kJOYtQ/E0BwC63sxpeq+QSJSiCN540EaIAAAAAAEbAAC63sxpeq+QSJSiCN540EaIAAHWGokmAAA="
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.new_email_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "AAMkADVjNTI3MTYxLTYyZDMtNGViYy04MTFhLWZjYjQxYzNmNmI2YwBGAAAAAACJMZRks2m2Qp8kJOYtQ/E0BwC63sxpeq+QSJSiCN540EaIAAAAAAEbAAC63sxpeq+QSJSiCN540EaIAAHWGokmAAA="
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Sender Blocked. Message moved to Junk Folder"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "email": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Email of the mailbox owner (used during impersonation)",
                                        "key": "email",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "id": {
                                        "contains": [
                                            "office 365 email id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Message ID to pick the sender of",
                                        "key": "id",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "move_to_junk_folder": {
                                        "data_type": "boolean",
                                        "default": null,
                                        "description": "Should the email be moved to the junk folder",
                                        "key": "move_to_junk_folder",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    }
                                },
                                "product_name": "Office 365",
                                "product_vendor": "Microsoft",
                                "targets": "51",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "block sender"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Contain"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_contain.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def block_sender_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('block_sender_1() called')\n\n    # collect data for 'block_sender_1' call\n\n    parameters = []\n    \n    # build parameters list for 'block_sender_1' call\n    parameters.append({\n        'id': \"AQMkADAwATM3ZmYAZS0xZTcwLTYxZGQALTAwAi0wMAoARgAAA8sbs2bgxWhOm/D/136MLx0HAHgHnxYkWTlOk6pq0IWFAMxLAAACAQwAAAB4B58WJFk5TpOqatCFhQDMSwAAAAyVhDwAAAA=\",\n        'move_to_junk_folder': \"\",\n        'email': \"\",\n    })\n\n    phantom.act(\"block sender\", parameters=parameters, assets=['office365'], callback=Block_Email_Result, name=\"block_sender_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "b99959e8-7935-4637-9302-06074ee6e239",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 165,
                        "line_start": 147,
                        "message": "Configuring now",
                        "name": "block sender",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 280,
                            "y": 100
                        },
                        "previous_function": "",
                        "previous_name": "block_sender_1",
                        "required_params": {
                            "id": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Contain",
                        "type": "coa.Action",
                        "warn": "",
                        "z": 123
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "call api",
                        "attrs": {
                            ".api": {
                                "text": "Block Email Result"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "xlink:href": "/inc/coa/img/block_icon_code_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "# read-only block view not available",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [],
                        "connected_to_start": true,
                        "connection_name": "block sender",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def Block_Email_Result(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('call_api_2() called')\n    phantom.debug(\"Successfully blocked the email\")\n    return",
                        "custom_join": "",
                        "custom_name": "Block Email Result",
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0b8c8157-6228-4d3a-8621-c0c05367a99a",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 37,
                        "line_start": 32,
                        "message": "Configuring now",
                        "name": "call api",
                        "notes": "",
                        "number": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 520,
                            "y": 100
                        },
                        "previous_function": "",
                        "previous_name": "Block_Email_Result",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "warn",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 124
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "call api",
                        "attrs": {
                            ".api": {
                                "text": "call api"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "xlink:href": "/inc/coa/img/block_icon_code_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "# read-only block view not available",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [],
                        "connected_to_start": false,
                        "connection_name": "run query 2",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def call_api_3(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('call_api_3() called')\n    phantom.debug(results)\n    return",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "884c929a-f2fb-48e2-b284-a60093406899",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 59,
                        "line_start": 54,
                        "message": "Configuring now",
                        "name": "call api",
                        "notes": "",
                        "number": 3,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1120,
                            "y": 600
                        },
                        "previous_function": "",
                        "previous_name": "call_api_3",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 125
                    },
                    {
                        "action": "delete email",
                        "action_type": "contain",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "app": "EWS for Office 365 Debug",
                        "approver": "",
                        "assets": [],
                        "attrs": {
                            ".action": {
                                "text": "delete email 2"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Contain"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_contain.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def delete_email_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('delete_email_2() called')\n\n    parameters = []\n\n    phantom.act(\"delete email\", parameters=parameters, app={ \"name\": 'EWS for Office 365 Debug' }, name=\"delete_email_2\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "a618b7d6-5bbe-4cdb-be8b-53072f047df9",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 174,
                        "line_start": 165,
                        "message": "Configuring now",
                        "name": "delete email",
                        "notes": "",
                        "number": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 740,
                            "y": 380
                        },
                        "previous_function": "",
                        "previous_name": "delete_email_2",
                        "required_params": {
                            "id": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "warn",
                        "title": "Contain",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 126
                    },
                    {
                        "action": "get email",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "container_id": "1734",
                            "email": "",
                            "id": "",
                            "ingest_email": "",
                            "vault_id": ""
                        },
                        "angle": 0,
                        "app": "EWS for Office 365",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get email",
                                "active": true,
                                "app_name": "EWS for Office 365",
                                "app_version": "1.0.87",
                                "asset_name": "office365",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "container_id": "1734",
                                    "email": "",
                                    "id": "",
                                    "ingest_email": "",
                                    "vault_id": ""
                                },
                                "has_app": true,
                                "id": 97,
                                "loaded": false,
                                "missing": false,
                                "name": "office365",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "phantom container id"
                                        ],
                                        "data_path": "action_result.parameter.container_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Email ID",
                                        "column_order": 3,
                                        "contains": [
                                            "exchange email id"
                                        ],
                                        "data_path": "action_result.parameter.id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.ingest_email",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.vault_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Content-Type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Date",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Delivered-To",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.From",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Importance",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.MIME-Version",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Mail-Filter-Gateway",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_path": "action_result.data.*.Message-ID",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Received",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Return-Path",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Sender",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.To",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Account-Key",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-CTCH-RefID",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-From",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-ID",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-SpamDetectionEngine",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-SpamScore",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-To",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mailer",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-MimeOLE",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mozilla-Keys",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Priority",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-SOHU-Antispam-Bayes",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-SOHU-Antispam-Language",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Spam-Status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-UIDL",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Body.#text",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Body.@BodyType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_DateTimeCreated",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_DateTimeReceived",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_DateTimeSent",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_HasAttachments",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_path": "action_result.data.*.t_InternetMessageId",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_IsAssociated",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_IsDeliveryReceiptRequested",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_IsRead",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_IsReadReceiptRequested",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ItemId.@ChangeKey",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ItemId.@Id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_LastModifiedTime",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_MimeContent.#text",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_MimeContent.@CharacterSet",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ResponseObjects.t_ForwardItem",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ResponseObjects.t_ReplyAllToItem",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ResponseObjects.t_ReplyToItem",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sensitivity",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Size",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_ToRecipients.t_Mailbox.*.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ToRecipients.t_Mailbox.*.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ToRecipients.t_Mailbox.*.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ToRecipients.t_Mailbox.*.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "phantom container id"
                                        ],
                                        "data_path": "action_result.summary.container_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "column_name": "Create Time",
                                        "column_order": 1,
                                        "data_path": "action_result.summary.create_time",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "exchange email id"
                                        ],
                                        "data_path": "action_result.summary.email_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "column_name": "Sent Time",
                                        "column_order": 2,
                                        "data_path": "action_result.summary.sent_time",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Subject",
                                        "column_order": 0,
                                        "data_path": "action_result.summary.subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "container_id": {
                                        "allow_list": true,
                                        "contains": [
                                            "phantom container id"
                                        ],
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Container ID to get email data from",
                                        "key": "container_id",
                                        "order": 2,
                                        "primary": true,
                                        "required": false
                                    },
                                    "email": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Email of the mailbox owner (used during impersonation)",
                                        "key": "email",
                                        "order": 1,
                                        "primary": false,
                                        "required": false
                                    },
                                    "id": {
                                        "allow_list": true,
                                        "contains": [
                                            "exchange email id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Message ID to get",
                                        "key": "id",
                                        "order": 0,
                                        "primary": true,
                                        "required": false
                                    },
                                    "ingest_email": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Create containers and artifacts",
                                        "key": "ingest_email",
                                        "order": 4,
                                        "primary": false,
                                        "required": false
                                    },
                                    "vault_id": {
                                        "allow_list": true,
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Vault ID to get email from",
                                        "key": "vault_id",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    }
                                },
                                "product_name": "Office 365",
                                "product_vendor": "Microsoft",
                                "targets": "51",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get email"
                            },
                            ".background": {
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def get_email_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('get_email_1() called')\n\n    # collect data for 'get_email_1' call\n\n    parameters = []\n    \n    # build parameters list for 'get_email_1' call\n    parameters.append({\n        'ingest_email': \"\",\n        'container_id': 1734,\n        'vault_id': \"\",\n        'id': \"\",\n        'email': \"\",\n    })\n\n    phantom.act(\"get email\", parameters=parameters, assets=['office365'], callback=delete_email_1, name=\"get_email_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "e5e4ffbf-a952-4a94-910c-0d91def5576b",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 128,
                        "line_start": 108,
                        "message": "Configuring now",
                        "name": "get email",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1000,
                            "y": 420
                        },
                        "previous_function": "",
                        "previous_name": "get_email_1",
                        "required_params": {},
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 127
                    },
                    {
                        "action": "run query",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "body": "",
                            "email": "soartesting2019@outlook.com",
                            "folder": "Inbox",
                            "ignore_subfolders": "",
                            "internet_message_id": "",
                            "query": "",
                            "range": "0-10",
                            "sender": "",
                            "subject": "test3"
                        },
                        "angle": 0,
                        "app": "EWS for Office 365",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run query",
                                "active": true,
                                "app_name": "EWS for Office 365",
                                "app_version": "1.0.87",
                                "asset_name": "office365",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "body": "",
                                    "email": "soartesting2019@outlook.com",
                                    "folder": "Inbox",
                                    "ignore_subfolders": "",
                                    "internet_message_id": "",
                                    "query": "",
                                    "range": "0-10",
                                    "sender": "",
                                    "subject": "test3"
                                },
                                "has_app": true,
                                "id": 97,
                                "loaded": false,
                                "missing": false,
                                "name": "office365",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.body",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "mail folder",
                                            "mail folder path"
                                        ],
                                        "data_path": "action_result.parameter.folder",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.ignore_subfolders",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_path": "action_result.parameter.internet_message_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.query",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.range",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.sender",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Folder",
                                        "column_order": 3,
                                        "contains": [
                                            "mail folder"
                                        ],
                                        "data_path": "action_result.data.*.folder",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Folder Path",
                                        "column_order": 4,
                                        "contains": [
                                            "mail folder path"
                                        ],
                                        "data_path": "action_result.data.*.folder_path",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Received Time",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.t_DateTimeReceived",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Internet Message ID",
                                        "column_order": 5,
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_path": "action_result.data.*.t_InternetMessageId",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ItemId.@ChangeKey",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message ID",
                                        "column_order": 6,
                                        "contains": [
                                            "office 365 email id"
                                        ],
                                        "data_path": "action_result.data.*.t_ItemId.@Id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Sender",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Subject",
                                        "column_order": 0,
                                        "data_path": "action_result.data.*.t_Subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.emails_matched",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "body": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Substring to search in Body",
                                        "key": "body",
                                        "order": 4,
                                        "primary": false,
                                        "required": false
                                    },
                                    "email": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "User's Email (Mailbox to search in)",
                                        "key": "email",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "folder": {
                                        "contains": [
                                            "mail folder",
                                            "mail folder path"
                                        ],
                                        "data_type": "string",
                                        "default": "Inbox",
                                        "description": "Folder Name/Path (to search in)",
                                        "key": "folder",
                                        "order": 1,
                                        "required": false
                                    },
                                    "ignore_subfolders": {
                                        "data_type": "boolean",
                                        "default": null,
                                        "description": "Ignore subfolders",
                                        "key": "ignore_subfolders",
                                        "order": 7,
                                        "required": false
                                    },
                                    "internet_message_id": {
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Internet Message ID",
                                        "key": "internet_message_id",
                                        "order": 5,
                                        "primary": false,
                                        "required": false
                                    },
                                    "query": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "AQS string",
                                        "key": "query",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "range": {
                                        "data_type": "string",
                                        "default": "0-10",
                                        "description": "Email range to return (min_offset-max_offset)",
                                        "key": "range",
                                        "order": 6,
                                        "required": false
                                    },
                                    "sender": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Sender Email address to match",
                                        "key": "sender",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "subject": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Substring to search in Subject",
                                        "key": "subject",
                                        "order": 2,
                                        "required": false
                                    }
                                },
                                "product_name": "Office 365",
                                "product_vendor": "Microsoft",
                                "targets": "51",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "run query 2"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def run_query_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('run_query_2() called')\n\n    # collect data for 'run_query_2' call\n\n    parameters = []\n    \n    # build parameters list for 'run_query_2' call\n    parameters.append({\n        'email': \"soartesting2019@outlook.com\",\n        'folder': \"Inbox\",\n        'subject': \"test3\",\n        'sender': \"\",\n        'body': \"\",\n        'internet_message_id': \"\",\n        'query': \"\",\n        'range': \"0-10\",\n        'ignore_subfolders': \"\",\n    })\n\n    phantom.act(\"run query\", parameters=parameters, assets=['office365'], callback=call_api_3, name=\"run_query_2\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "a39437ef-d373-42af-9b75-4e6159137fe6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 198,
                        "line_start": 174,
                        "message": "Configuring now",
                        "name": "run query",
                        "notes": "",
                        "number": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 820,
                            "y": 580
                        },
                        "previous_function": "",
                        "previous_name": "run_query_2",
                        "required_params": {
                            "email": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": "",
                        "z": 128
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "788bc2bd-b10c-4ae9-8364-c72ebb099d67",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fccef927-3404-42bc-ae37-99f6c141531a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a39437ef-d373-42af-9b75-4e6159137fe6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 129
                    }
                ]
            },
            "notes": ""
        },
        "schema": 3,
        "version": "3.5.200"
    },
    "create_time": "2019-02-22T11:18:59.737747+00:00",
    "draft_mode": false,
    "labels": [
        "*"
    ]
}